import{d as y,g as M,c as d,F as E,a as $,e as r,h,t as P,i as R,f as L,m as O,j as F,_ as b,C as H,k as J,b as N,l as V,n as f,w as k,E as D,r as v,p as U,q as j,o as q,s as g,u as z,v as G,x as K,y as Q,z as w,A as W,B as X}from"./index-B03LQxf_.js";import{g as T,s as Y}from"./dataUtils-CiMVzcWh.js";const Z={class:"lc-attr-list"},ee={key:0},te=y({__name:"AttrList",props:{attrs:{},data:{}},setup(o){const t=o,a=M({get:()=>t.attrs.map(s=>b.get(t.data,s.name,"")),set:s=>{t.attrs.forEach((p,c)=>b.set(t.data,p.name,s[c]))}});function i(s,p){b.set(t.data,p,s)}return(s,p)=>(r(),d("div",Z,[(r(!0),d(E,null,$(s.attrs,(c,l)=>(r(),d("div",{key:c.name,class:"lc-comp"},[h(P(c.title)+" ",1),c.type?(r(),d("div",ee)):R("",!0),(r(),L(F(c.component),O({modelValue:a.value[l],"onUpdate:modelValue":n=>a.value[l]=n},c.componentProps||{},{onInput:n=>i(a.value[l],c.name),onChange:n=>i(a.value[l],c.name)}),null,16,["modelValue","onUpdate:modelValue","onInput","onChange"]))]))),128))]))}}),oe={class:"lc-comp-tree"},ne=y({__name:"CompTree",props:{elements:{}},emits:["select","change"],setup(o,{emit:t}){const a=o,i=t,s={key:"id",label:"compCode",children:"elements"};function p(n){i("select",n)}function c(n,m,e,u){i("change",a.elements)}function l(n,m,e){return e=="inner"&&m.data.compType!==H.Layout?!1:!(m.data.compCode===J.Page&&e!=="inner")}return(n,m)=>{const e=N("el-tree");return r(),d("div",oe,[(r(),L(e,{key:n.key,data:n.elements,props:s,"expand-on-click-node":!1,"allow-drop":l,"highlight-current":"","default-expand-all":"",draggable:"",onNodeClick:p,onNodeDrop:c},null,8,["data"]))])}}}),ae={class:"lc-comp-list"},se=["data-comp-code"],ce=y({__name:"CompList",props:{comps:{}},setup(o){function t(a){console.log("dragstart",a,a.target.dataset.compCode),a.dataTransfer.setData("compCode",a.target.dataset.compCode),console.log(a.dataTransfer.getData("compCode"))}return(a,i)=>(r(),d("div",ae,[(r(!0),d(E,null,$(a.comps,s=>(r(),d(E,{key:s.compCode},[s.hidden?R("",!0):(r(),d("div",{key:0,class:"lc-comp",draggable:"true","data-comp-code":s.compCode,onDragstart:t},P(s.title||s.compCode),41,se))],64))),128))]))}}),re=V(ce,[["__scopeId","data-v-bffaf234"]]),le={class:"lc-designer-header"},de=y({__name:"EditorHeader",props:{elements:{}},emits:["reset"],setup(o,{emit:t}){const a=t,i=o;function s(){const n=T();a("reset",n),D("reset: "+JSON.stringify(n))}function p(){const n=Y(i.elements);D("save: "+n)}function c(){const n=T();a("reset",n),D("init: "+JSON.stringify(n))}function l(){window.open(window.location.origin+"/runtime")}return(n,m)=>{const e=N("el-button");return r(),d("div",le,[f(e,{onClick:c},{default:k(()=>[h("初始化")]),_:1}),f(e,{onClick:s},{default:k(()=>[h("重置")]),_:1}),f(e,{onClick:p},{default:k(()=>[h("保存")]),_:1}),f(e,{onClick:l},{default:k(()=>[h("预览")]),_:1})])}}}),ie=V(de,[["__scopeId","data-v-8c570e13"]]);function S(o,t){for(;o;){if(o.classList.contains(t))return o;if(o.classList.contains("lc-stage"))return null;o=o.parentElement}return o}function pe(o){return S(o,"lc-layout")}function ue(o){return S(o,"lc-comp")}function me(o){return o.getAttribute("lc-id")}const _e={class:"lc-designer"},fe={class:"lc-designer-header"},ge={class:"lc-designer-body"},ve={class:"lc-designer-body-item left"},Ce={class:"lc-designer-body-item-item top"},he={class:"lc-designer-body-item-item bottom"},ye={class:"lc-designer-body-item right"},ke=y({__name:"Editor",setup(o){const t=v([{compCode:"LcPage",id:"null",compType:3}]),a=v(null);w("allElements",t),w("edit",!0);const i=v([]);w("pageTreeData",i),U(()=>{var e,u;i.value=W(((u=(e=t.value[0])==null?void 0:e.props)==null?void 0:u.variables)||{})});const s=v(X);function p(e){t.value=e}function c(e){var I;const u=(I=e.dataTransfer)==null?void 0:I.getData("compCode");if(!u)return;let _;const C=pe(e.target);if(C!=null){const x=ue(C),A=me(x);_=G(t.value,A)}_==null&&(_=t.value[0]),_.elements==null&&(_.elements=[]);const B=K(u);if(!B)throw new Error("未找到父节点");_.elements.push(B)}const l=v({});function n(e){l.value=e,m.value=Q(e.compCode)}const m=v([{title:"标题",name:"title",compCode:"el-input"}]);return j(()=>l.value,e=>{console.log("val",e)}),q(()=>{const e=T();t.value=e}),(e,u)=>{const _=N("CompRender");return r(),d("div",_e,[g("div",fe,[f(ie,{elements:t.value,onReset:p},null,8,["elements"])]),g("div",ge,[g("div",ve,[g("div",Ce,[f(re,{comps:s.value},null,8,["comps"])]),g("div",he,[f(ne,{ref_key:"compTreeRef",ref:a,elements:t.value,onSelect:n,onChange:e.change},null,8,["elements","onChange"])])]),g("div",{class:"lc-designer-body-item center lc-stage","drag-end":"",onDrop:c,onDragover:u[0]||(u[0]=z(()=>{},["prevent"]))},[(r(!0),d(E,null,$(t.value,C=>(r(),L(_,{key:C.id,element:C},null,8,["element"]))),128))],32),g("div",ye,[f(te,{attrs:m.value,data:l.value.props},null,8,["attrs","data"])])])])}}}),De=V(ke,[["__scopeId","data-v-f13b3f09"]]);export{De as default};
